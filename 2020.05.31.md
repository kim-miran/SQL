# SQL  
  
## SQL 최적화 기본 원리  
  
### 1. 옵티마이저  
  
옵티마이저? 사용자가 질의한 SQL문에 대해 최적의 실행 방법을 결정하는 역할 수행  
  
옵티마이저 역할? 다양한 실행 방법들 중에서 최적의 실행 방법을 결정하는 것  
  
1. 규칙 기반 옵티마이저  
  
: 규칙을 가지고 실행 계획을 생성  
실행 계획을 생성할 때 참조하는 정보에는 SQL문을 실행하기 위해서 이용 가능한 인덱스 유무와 종류, SQL문에서 사용하는 연산자의 종류 그리고 SQL 문에서 참조하는 객체의 종류가 있음  
  
2. 비용 기반 옵티마이저  
  
: 조건절에서 '=' 연산자와 'BETWEEN' 연산자가 사용되면 규칙에 따라 '=' 칼럼의 인덱스를 사용하는 것 보다 적은 일량 즉, 보다 적은 처리 범위로 작업을 할 것이라고 판단  
  
실행계획? SQL에서 요구한 사항을 처리하기 위한 절차와 방법을 의미  
실행계획을 구성하는 요소에는 조인 순서, 조인 기법, 액세서 기법, 최적화 정보, 연산 등이 있음  
  
### 2. 인덱스 기본  
  
인덱스? 원하는 데이터를 쉽게 찾을 수 있도록 도움  
  
인덱스의 기본적 목적? 검색 성능의 최적화  
인덱스의 단점? INSERT, UPDATE, DELETE 등과 같은 DML 작업은 테이블과 인덱스를 함께 변경해야 하기 때문에 느려질 수 있음  
  
B-TREE 인덱스에서 원하는 값을 찾는 과정  
  
1. 브랜치 블록의 가장 왼쪽 값이 찾고자 하는 값보다 작거나 같으면 왼쪽 포인터로 이동  
  
2. 찾고자 하는 값이 브랜치 블록의 값 사이에 존재하면 가운데 포인터로 이동  
  
3. 오른쪽에 있는 값보다 크면 오른쪽 포인터로 이동  
  
전체 테이블 스캔  : 테이블에 존재하는 모든 데이터를 읽어 가면서 조건에 맞으면 결과로서 추출하고 조건에 맞지 않으면 버리는 방식으로 검색  
  
전체 테이블 스캔을 하는 경우  
  
1. SQL문에 조건이 존재하지 않는 경우  
  
2. SQL문의 주어진 조건에 사용 가능한 인덱스가 존재하지 않는 경우  
  
3. 옵티마이저의 취사 선택  
  
4. 병렬처리 방식으로 처리하는 경우 등  
  
인덱스 스캔  : 인덱스를 구성하는 칼럼의 값을 기반으로 데이터를 추출하는 액세스 기법  
  
인덱스 유일 스캔  : 유일 인덱스를 사용하여 단 하나의 데이터를 추출하는 방식(중복X, 구성 칼럼에 대해 모두 ‘=’ 로 값이 주어진 경우에만 가능)  
  
인덱스 범위 스캔  : 인덱스를 이용하여 한 건 이상의 데이터를 추출하는 방식  
  
인덱스 역순 범위 스캔 : 인덱스의 리프 블록의 양방향 링크를 이용하여 내림차순으로 데이터를 읽는다
  
NL Join  : 프로그래밍에서 사용하는 중첩된 반복문과 유사한 방식으로 조인을 수행, 랜덤 액세스 방식으로 데이터를 읽음  
  
Sort Merge Join  : 조인 칼럼을 기준으로 데이터를 정렬하여 조인을 수행, 스캔 방식으로 데이터 읽음  
  
Hash Join  : CPU 작업 위주로 처리, 해슁 기법 이용, NL Join의 랜덤 액세스 문제와 SMJ의 정렬 작업 부담을 해결하기 위한 대안으로 등장    
